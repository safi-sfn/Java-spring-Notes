# 🌟 SpringBoot Profiles - Complete Study Guide 🌟

---

## 📚 Introduction with Confusion Clearing

### Simple Explanation First 🤔
Bhai, **SpringBoot Profile** ka matlab simple hai - imagine karo tumhare paas ek app hai jo different environments mein run hota hai (development, testing, production). Har environment ke liye alag-alag configuration chahiye hoti hai! Profile basically ek way hai to organize these different configurations.

### Real-life Analogy 🏠
Think of it like your wardrobe, yaar! 👔
- **Summer ke kapde** - light colors, cotton (Development Profile)
- **Winter ke kapde** - heavy jackets, woolen (Production Profile) 
- **Rainy season ke kapde** - waterproof, umbrella (Testing Profile)

Same person, different occasions = Same app, different environments!

### Technical Definition 💻
> **SpringBoot Profile** is a way to segregate parts of your application configuration and make it only available in certain environments. It allows you to define different configurations for different deployment environments.

---

## 🔑 Key Terms/Concepts

| Term | Hindi/English Mix Explanation | Visual |
|------|------------------------------|---------|
| **Profile** | Environment-specific configuration ka bundle | 📦 |
| **Active Profile** | Currently jo profile use ho raha hai | ✅ |
| **Default Profile** | Jab koi profile specify nahi kiya to ye chalega | 🎯 |
| **Profile-specific Properties** | Har profile ke liye alag properties file | 📋 |
| **Conditional Beans** | Profile ke basis par beans create karna | 🏗️ |

### Visual Representation 📊
```
Application
    ├── Dev Profile (localhost, H2 DB, debug logs)
    ├── Test Profile (test server, test DB, info logs)
    └── Prod Profile (production server, MySQL, error logs)
```

---

## 💡 Detailed Examples

### Example 1: Basic Profile Configuration 🚀

**application.properties** (Default)
```properties
# Default configuration
server.port=8080
app.name=MyAwesomeApp
logging.level.root=INFO
```

**application-dev.properties** (Development)
```properties
# Development environment
server.port=8081
spring.datasource.url=jdbc:h2:mem:devdb
spring.h2.console.enabled=true
logging.level.com.myapp=DEBUG
app.environment=Development
```

**application-prod.properties** (Production)
```properties
# Production environment
server.port=80
spring.datasource.url=jdbc:mysql://prod-server:3306/myapp
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
logging.level.root=ERROR
app.environment=Production
```

**Expected Output when running with dev profile:**
```bash
Started MyAwesomeApp on localhost:8081
Environment: Development
H2 Console available at: http://localhost:8081/h2-console
```

### Example 2: Profile-specific Beans 🏗️

```java
@Configuration
public class DatabaseConfig {
    
    @Bean
    @Profile("dev")
    public DataSource devDataSource() {
        System.out.println("🚀 Dev Database initialized - H2 in-memory");
        return new EmbeddedDatabaseBuilder()
                .setType(EmbeddedDatabaseType.H2)
                .build();
    }
    
    @Bean
    @Profile("prod")
    public DataSource prodDataSource() {
        System.out.println("💼 Production Database initialized - MySQL");
        HikariConfig config = new HikariConfig();
        config.setJdbcUrl("jdbc:mysql://prod-server:3306/myapp");
        config.setUsername("admin");
        config.setPassword("secretPassword");
        return new HikariDataSource(config);
    }
    
    @Bean
    @Profile({"test", "staging"})
    public DataSource testDataSource() {
        System.out.println("🧪 Test Database initialized");
        return new EmbeddedDatabaseBuilder()
                .setType(EmbeddedDatabaseType.H2)
                .setName("testdb")
                .build();
    }
}
```

### Example 3: Component with Profile 🎯

```java
@Component
@Profile("dev")
public class DevMailService implements MailService {
    
    @Override
    public void sendMail(String to, String subject, String body) {
        System.out.println("📧 [DEV MODE] Mail would be sent to: " + to);
        System.out.println("📧 Subject: " + subject);
        System.out.println("📧 Body: " + body);
    }
}

@Component
@Profile("prod")
public class ProdMailService implements MailService {
    
    @Autowired
    private JavaMailSender mailSender;
    
    @Override
    public void sendMail(String to, String subject, String body) {
        SimpleMailMessage message = new SimpleMailMessage();
        message.setTo(to);
        message.setSubject(subject);
        message.setText(body);
        mailSender.send(message);
        System.out.println("✅ Mail sent successfully to: " + to);
    }
}
```

---

## 📏 Rules/Guidelines

### Rule 1: Profile Naming Convention ✅
```yaml
# ✅ Correct way
spring:
  profiles:
    active: dev,swagger

# ❌ Wrong way (spaces and special chars)
spring:
  profiles:
    active: "dev environment", "test@staging"
```

### Rule 2: Profile-specific Files ✅
```
✅ Correct file structure:
src/main/resources/
├── application.properties          (default)
├── application-dev.properties     (dev profile)
├── application-test.properties    (test profile)
└── application-prod.properties    (prod profile)

❌ Wrong naming:
├── application_dev.properties     (underscore not allowed)
├── dev-application.properties     (wrong order)
```

### Rule 3: Environment Variables Priority ✅
```bash
# ✅ Correct - Environment variable overrides
export SPRING_PROFILES_ACTIVE=prod
java -jar myapp.jar

# ✅ Correct - Command line argument
java -jar myapp.jar --spring.profiles.active=prod

# ✅ Correct - JVM argument
java -Dspring.profiles.active=prod -jar myapp.jar
```

### Rule 4: Multiple Profiles ✅
```properties
# ✅ Correct way to activate multiple profiles
spring.profiles.active=dev,swagger,logging

# ❌ Wrong way
spring.profiles.active=dev swagger logging  # No commas
```

**Error Example:**
```bash
❌ When wrong profile name is used:
Error: The following profiles are active: "dev environment"
Invalid profile name: "dev environment". 
Profile names must not contain spaces or special characters.
```

---

## 🌍 Real-world Applications

### Banking Application Example 🏦

```java
@RestController
@RequestMapping("/api/transactions")
public class TransactionController {
    
    @Autowired
    private PaymentGateway paymentGateway;
    
    @PostMapping("/payment")
    public ResponseEntity<String> processPayment(@RequestBody PaymentRequest request) {
        return paymentGateway.processPayment(request);
    }
}

// Development Profile - Mock Payment Gateway
@Service
@Profile("dev")
public class MockPaymentGateway implements PaymentGateway {
    @Override
    public ResponseEntity<String> processPayment(PaymentRequest request) {
        System.out.println("💳 [MOCK] Processing payment: ₹" + request.getAmount());
        return ResponseEntity.ok("Payment successful (MOCK)");
    }
}

// Production Profile - Real Payment Gateway
@Service
@Profile("prod")
public class RazorpayGateway implements PaymentGateway {
    @Override
    public ResponseEntity<String> processPayment(PaymentRequest request) {
        // Real Razorpay integration code
        System.out.println("💰 [REAL] Processing payment through Razorpay");
        return ResponseEntity.ok("Payment processed successfully");
    }
}
```

### E-commerce Application 🛒

**application-dev.properties**
```properties
# Development - Local setup
app.payment.gateway=mock
app.email.service=console
app.file.upload.path=/tmp/uploads
logging.level.com.ecommerce=DEBUG
```

**application-prod.properties**
```properties
# Production - Live setup
app.payment.gateway=stripe
app.email.service=aws-ses
app.file.upload.path=/var/uploads
logging.level.root=WARN
```

---

## 🔄 Comparison Tables

### Profile Configuration Methods

| Method | Example | Priority | Use Case |
|--------|---------|----------|-----------|
| `application.properties` | `spring.profiles.active=dev` | 3 | Default configuration |
| Environment Variable | `SPRING_PROFILES_ACTIVE=prod` | 1 | Docker/Kubernetes |
| Command Line | `--spring.profiles.active=test` | 2 | Local testing |
| JVM Argument | `-Dspring.profiles.active=dev` | 2 | IDE configuration |
| `@ActiveProfiles` | `@ActiveProfiles("test")` | Test only | Unit/Integration tests |

### Profile vs Environment

| Aspect | Profile | Environment Variable |
|--------|---------|---------------------|
| **Flexibility** | High - multiple profiles | Medium |
| **Configuration** | File-based | Runtime-based |
| **Override** | Can be overridden | Highest priority |
| **Use Case** | Application configuration | Deployment configuration |

---

## 🎤 Interview Questions

### Q1: What are SpringBoot Profiles and why do we use them?

**Answer:** 
```java
/*
Bhai, SpringBoot Profiles are like different costumes for your application!
- They help in environment-specific configuration
- Separate concerns for dev, test, prod
- Enable/disable features based on environment
- Switch between different implementations
*/

// Example of profile usage
@Component
@Profile("!prod")  // Active in all profiles except prod
public class DebugComponent {
    // Debug-specific code
}
```

### Q2: How do you activate a profile in SpringBoot?

**Answer:**
```bash
# Method 1: application.properties
spring.profiles.active=dev

# Method 2: Command line
java -jar app.jar --spring.profiles.active=dev

# Method 3: Environment variable
export SPRING_PROFILES_ACTIVE=dev

# Method 4: JVM argument
java -Dspring.profiles.active=dev -jar app.jar

# Method 5: Programmatically
@SpringBootApplication
public class Application {
    public static void main(String[] args) {
        System.setProperty("spring.profiles.active", "dev");
        SpringApplication.run(Application.class, args);
    }
}
```

### Q3: What is the difference between @Profile and @Conditional?

**Answer:**
```java
// @Profile - Environment-based
@Component
@Profile("dev")
public class DevMailService implements MailService {
    // Only created when 'dev' profile is active
}

// @Conditional - Custom condition
@Component
@Conditional(WindowsCondition.class)
public class WindowsFileService implements FileService {
    // Only created when condition is true
}

public class WindowsCondition implements Condition {
    @Override
    public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
        return System.getProperty("os.name").toLowerCase().contains("windows");
    }
}
```

### Q4: How do you test with specific profiles?

**Answer:**
```java
@SpringBootTest
@ActiveProfiles("test")
class UserServiceTest {
    
    @Autowired
    private UserService userService;
    
    @Test
    void testUserCreation() {
        // Test code here
        // Will use test profile configuration
    }
}

// Alternative way
@TestPropertySource(properties = {
    "spring.profiles.active=test,h2"
})
class IntegrationTest {
    // Test implementation
}
```

---

## ❌ Common Mistakes

### Mistake 1: Profile File Naming 🚫
```bash
❌ Wrong naming:
application_dev.properties     # Underscore instead of hyphen
dev-application.properties     # Wrong order
application-dev.yml.properties # Mixed extensions

✅ Correct naming:
application-dev.properties
application-dev.yml
application-dev.yaml
```

### Mistake 2: Profile Expression Confusion 🤯
```java
❌ Wrong profile expressions:
@Profile("dev & test")        # AND doesn't work like this
@Profile("dev OR test")       # Wrong syntax

✅ Correct profile expressions:
@Profile({"dev", "test"})     # OR condition
@Profile("!prod")             # NOT condition
@Profile("dev & swagger")     # AND condition (correct syntax)
```

### Mistake 3: Environment Variable Override Issue 🔧
```bash
❌ Common mistake:
# Setting in application.properties
spring.profiles.active=dev

# But environment variable overrides it
export SPRING_PROFILES_ACTIVE=prod

# Result: prod profile runs, not dev! 😱

✅ Solution: Be aware of precedence order!
```

### Mistake 4: Profile-specific Bean Not Working 🏗️
```java
❌ Wrong approach:
@Component
@Profile("dev")
public class DevService {
    // This won't work if bean is autowired in a @Configuration
    // that's not profile-specific
}

✅ Correct approach:
@Configuration
@Profile("dev")
public class DevConfiguration {
    
    @Bean
    public DevService devService() {
        return new DevService();
    }
}
```

---

## 🏆 Best Practices

### 1. Configuration Organization 📁
```
src/main/resources/
├── application.yml                 # Common configuration
├── application-dev.yml            # Development
├── application-test.yml           # Testing
├── application-staging.yml        # Staging
├── application-prod.yml           # Production
└── profiles/
    ├── database-dev.yml           # Profile-specific modules
    └── security-prod.yml
```

### 2. Use YAML for Better Organization 📝
```yaml
# application.yml
spring:
  profiles:
    active: dev
    group:
      production: "prod,swagger,db"
      testing: "test,h2,mock"

---
# Dev profile section
spring:
  config:
    activate:
      on-profile: dev
  datasource:
    url: jdbc:h2:mem:devdb
    username: sa
    password: password
  h2:
    console:
      enabled: true

---
# Prod profile section  
spring:
  config:
    activate:
      on-profile: prod
  datasource:
    url: jdbc:mysql://prod-server:3306/myapp
    username: ${DB_USERNAME:admin}
    password: ${DB_PASSWORD:secret}
```

### 3. Profile-specific Logging 📊
```yaml
# application-dev.yml
logging:
  level:
    com.myapp: DEBUG
    org.springframework.web: DEBUG
  pattern:
    console: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# application-prod.yml
logging:
  level:
    root: WARN
    com.myapp: INFO
  file:
    name: /var/logs/myapp.log
  pattern:
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
```

### 4. Security Best Practices 🔐
```yaml
# application-prod.yml
spring:
  datasource:
    password: ${DB_PASSWORD}     # Use environment variables
  security:
    user:
      name: ${ADMIN_USER}
      password: ${ADMIN_PASSWORD}

# Don't hardcode secrets! ❌
# password: mySecretPassword123
```

### 5. Feature Toggles with Profiles 🎛️
```java
@RestController
public class FeatureController {
    
    @GetMapping("/experimental")
    @Profile("dev | staging")
    public ResponseEntity<String> experimentalFeature() {
        return ResponseEntity.ok("🧪 This is an experimental feature!");
    }
    
    @GetMapping("/beta")
    @Profile("!prod")
    public ResponseEntity<String> betaFeature() {
        return ResponseEntity.ok("🚀 Beta feature - not in production yet!");
    }
}
```

---

## 📋 Summary/Quick Recap

### Key Takeaways 🎯

1. **Profile Purpose**: Environment-specific configurations ke liye use karte hain
2. **Activation Methods**: Properties, environment variables, command line
3. **File Naming**: `application-{profile}.properties/yml`
4. **Bean Control**: `@Profile` annotation se conditional beans banate hain
5. **Priority Order**: Environment > Command Line > Properties file

### Memory Tricks 🧠

| Concept | Trick | Example |
|---------|-------|---------|
| **Profile naming** | "Hyphen hai hero" | `application-dev.properties` |
| **Multiple profiles** | "Comma lagao, multiple chalao" | `dev,swagger,logging` |
| **NOT condition** | "Exclamation se exclusion" | `@Profile("!prod")` |
| **Environment override** | "Environment is Emperor" | Highest priority |

### When to Use What 🤔

```yaml
Use Profiles When:
✅ Different databases for different environments
✅ Feature toggles (experimental features)
✅ Different logging levels
✅ Mock vs real services
✅ Environment-specific configurations

Don't Use Profiles For:
❌ Business logic decisions
❌ User-specific configurations
❌ Runtime dynamic changes
❌ Complex conditional logic
```

### Quick Commands Cheat Sheet 💻

```bash
# Check active profiles
curl localhost:8080/actuator/env | grep spring.profiles

# Run with specific profile
java -jar app.jar --spring.profiles.active=prod

# Multiple profiles
java -jar app.jar --spring.profiles.active=prod,swagger,monitoring

# Environment variable
export SPRING_PROFILES_ACTIVE=dev && java -jar app.jar
```

---

## 🎉 Yaad Rakhne Ka Mantra

**"Profile hai environment ka dost,**  
**Configuration ko rakhta hai organized aur robust!"** 🚀

**Remember bhai:** 
- Development mein `dev` profile
- Testing mein `test` profile  
- Production mein `prod` profile
- Aur emergency mein Google search! 😄

---

*Happy Coding! 💻✨*

> **Pro Tip**: Hamesha profile-specific configuration test karo before production deployment. "Testing is caring!" 🧪❤️
