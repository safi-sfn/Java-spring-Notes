# ğŸ”¢ JPA Repository Count Method - Complete Study Guide

## ğŸ“š 1. Introduction with Confusion Clearing

### Simple Explanation First ğŸ¤”
Bhai, **Count method** ka matlab simple hai - database table mein kitne records hai, ye count karna! Jaise tu apne phone mein contacts count karta hai, waise hi JPA mein tables ke records count karte hain.

### Real-life Analogy ğŸ 
Imagine kar tu ek library ka manager hai:
- **count()** = Library mein total kitni books hain? 
- **countByCategory("Fiction")** = Fiction category mein kitni books hain?
- **countByAuthor("Chetan Bhagat")** = Chetan Bhagat ki kitni books hain?

### Technical Definition ğŸ“–
Count method is a query method of the JpaRepository interface to return the total number of entities in the JpaRepository that helps in getting dataset size, pagination, and verifying existence of records based on specific criteria.

---

## ğŸ”‘ 2. Key Terms/Concepts

| Term | Hindi Meaning | Technical Meaning |
|------|---------------|-------------------|
| **count()** | à¤—à¤¿à¤¨à¤¨à¤¾ | Total records return karta hai |
| **countBy** | à¤¶à¤°à¥à¤¤ à¤•à¥‡ à¤¸à¤¾à¤¥ à¤—à¤¿à¤¨à¤¨à¤¾ | Conditional counting method |
| **JpaRepository** | à¤¡à¥‡à¤Ÿà¤¾ à¤°à¤¿à¤ªà¥‹à¤œà¤¿à¤Ÿà¤°à¥€ | Spring Data JPA interface |
| **Query Method** | à¤ªà¥‚à¤›à¤¤à¤¾à¤› à¤¤à¤°à¥€à¤•à¤¾ | Database query without SQL |

### Visual Representation ğŸ¯
```
Database Table: USERS
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID  â”‚ NAME â”‚     EMAIL       â”‚  STATUS  â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1  â”‚ Raj  â”‚ raj@gmail.com   â”‚ Active   â”‚
â”‚  2  â”‚ Simranâ”‚simran@gmail.comâ”‚ Inactive â”‚
â”‚  3  â”‚ Rohit â”‚rohit@gmail.com â”‚ Active   â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

count() â†’ 3 (total records)
countByStatus("Active") â†’ 2 (active users)
countByStatus("Inactive") â†’ 1 (inactive users)
```

---

## ğŸ’» 3. Detailed Examples

### Basic Setup ğŸ—ï¸

#### Entity Class
```java
package com.example.entity;

import javax.persistence.*;
import lombok.Data;

@Data
@Entity
@Table(name = "users")
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(nullable = false)
    private String name;
    
    @Column(unique = true)
    private String email;
    
    private String status;
    private Integer age;
    private String city;
}
```

#### Repository Interface
```java
package com.example.repository;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import com.example.entity.User;

public interface UserRepository extends JpaRepository<User, Long> {
    
    // 1ï¸âƒ£ Basic count by property
    long countByStatus(String status);
    
    // 2ï¸âƒ£ Count by multiple properties  
    long countByStatusAndCity(String status, String city);
    
    // 3ï¸âƒ£ Count with comparison operators
    long countByAgeGreaterThan(Integer age);
    long countByAgeLessThan(Integer age);
    long countByAgeBetween(Integer startAge, Integer endAge);
    
    // 4ï¸âƒ£ Count with LIKE operations
    long countByNameContaining(String namePart);
    long countByEmailStartingWith(String prefix);
    long countByEmailEndingWith(String suffix);
    
    // 5ï¸âƒ£ Count with custom JPQL query
    @Query("SELECT COUNT(u) FROM User u WHERE u.status = :status AND u.age > :age")
    long countActiveUsersAboveAge(@Param("status") String status, @Param("age") Integer age);
    
    // 6ï¸âƒ£ Count with native SQL query
    @Query(value = "SELECT COUNT(*) FROM users WHERE status = ?1 AND city = ?2", nativeQuery = true)
    long countByStatusAndCityNative(String status, String city);
}
```

#### Service Class
```java
package com.example.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import com.example.entity.User;
import com.example.repository.UserRepository;

@Service
public class UserService {
    
    @Autowired
    private UserRepository userRepository;
    
    // Total users count
    public long getTotalUsersCount() {
        return userRepository.count();
    }
    
    // Count by status
    public long getActiveUsersCount() {
        return userRepository.countByStatus("Active");
    }
    
    // Count by multiple conditions
    public long getActiveUsersInCity(String city) {
        return userRepository.countByStatusAndCity("Active", city);
    }
    
    // Count by age range
    public long getAdultUsersCount() {
        return userRepository.countByAgeGreaterThan(18);
    }
    
    // Count with name pattern
    public long getUsersWithNamePattern(String pattern) {
        return userRepository.countByNameContaining(pattern);
    }
    
    // Custom query count
    public long getActiveAdultsCount() {
        return userRepository.countActiveUsersAboveAge("Active", 18);
    }
}
```

### Complete Working Example ğŸ¯

```java
package com.example;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import com.example.entity.User;
import com.example.service.UserService;

@SpringBootApplication
public class CountDemoApplication implements CommandLineRunner {
    
    @Autowired
    private UserService userService;
    
    @Autowired
    private UserRepository userRepository;
    
    public static void main(String[] args) {
        SpringApplication.run(CountDemoApplication.class, args);
    }
    
    @Override
    public void run(String... args) throws Exception {
        // Sample data insert kar rahe hain
        insertSampleData();
        
        // Different count operations
        demonstrateCountOperations();
    }
    
    private void insertSampleData() {
        System.out.println("ğŸ¯ Inserting sample data...\n");
        
        // User 1
        User user1 = new User();
        user1.setName("Raj Sharma");
        user1.setEmail("raj@gmail.com");
        user1.setStatus("Active");
        user1.setAge(25);
        user1.setCity("Mumbai");
        
        // User 2  
        User user2 = new User();
        user2.setName("Priya Singh");
        user2.setEmail("priya@gmail.com");
        user2.setStatus("Inactive");
        user2.setAge(22);
        user2.setCity("Delhi");
        
        // User 3
        User user3 = new User();
        user3.setName("Rohit Kumar");
        user3.setEmail("rohit@gmail.com");
        user3.setStatus("Active");
        user3.setAge(30);
        user3.setCity("Mumbai");
        
        // User 4
        User user4 = new User();
        user4.setName("Simran Kaur");
        user4.setEmail("simran@gmail.com");
        user4.setStatus("Active");
        user4.setAge(17);
        user4.setCity("Delhi");
        
        userRepository.save(user1);
        userRepository.save(user2);
        userRepository.save(user3);
        userRepository.save(user4);
        
        System.out.println("âœ… Sample data inserted successfully!\n");
    }
    
    private void demonstrateCountOperations() {
        System.out.println("ğŸ”¢ Count Operations Demo:");
        System.out.println("========================\n");
        
        // 1. Total count
        long totalUsers = userService.getTotalUsersCount();
        System.out.println("ğŸ‘¥ Total Users: " + totalUsers);
        
        // 2. Count by status
        long activeUsers = userService.getActiveUsersCount();
        long inactiveUsers = userRepository.countByStatus("Inactive");
        System.out.println("âœ… Active Users: " + activeUsers);
        System.out.println("âŒ Inactive Users: " + inactiveUsers);
        
        // 3. Count by city
        long mumbaiUsers = userRepository.countByStatusAndCity("Active", "Mumbai");
        System.out.println("ğŸ™ï¸ Active Users in Mumbai: " + mumbaiUsers);
        
        // 4. Count by age
        long adultUsers = userService.getAdultUsersCount();
        long youngUsers = userRepository.countByAgeLessThan(25);
        System.out.println("ğŸ‘¨ Adult Users (18+): " + adultUsers);
        System.out.println("ğŸ‘¶ Young Users (<25): " + youngUsers);
        
        // 5. Count with name pattern
        long usersWithR = userService.getUsersWithNamePattern("R");
        System.out.println("ğŸ”¤ Users with 'R' in name: " + usersWithR);
        
        // 6. Custom query count
        long activeAdults = userService.getActiveAdultsCount();
        System.out.println("ğŸ’ª Active Adult Users: " + activeAdults);
    }
}
```

### Expected Output ğŸ“Š
```
ğŸ¯ Inserting sample data...

Hibernate: insert into users (age, city, email, name, status) values (?, ?, ?, ?, ?)
Hibernate: insert into users (age, city, email, name, status) values (?, ?, ?, ?, ?)
Hibernate: insert into users (age, city, email, name, status) values (?, ?, ?, ?, ?)
Hibernate: insert into users (age, city, email, name, status) values (?, ?, ?, ?, ?)

âœ… Sample data inserted successfully!

ğŸ”¢ Count Operations Demo:
========================

Hibernate: select count(*) as col_0_0_ from users user0_
ğŸ‘¥ Total Users: 4

Hibernate: select count(user0_.id) as col_0_0_ from users user0_ where user0_.status=?
âœ… Active Users: 3

Hibernate: select count(user0_.id) as col_0_0_ from users user0_ where user0_.status=?
âŒ Inactive Users: 1

Hibernate: select count(user0_.id) as col_0_0_ from users user0_ where user0_.status=? and user0_.city=?
ğŸ™ï¸ Active Users in Mumbai: 2

Hibernate: select count(user0_.id) as col_0_0_ from users user0_ where user0_.age>?
ğŸ‘¨ Adult Users (18+): 3

Hibernate: select count(user0_.id) as col_0_0_ from users user0_ where user0_.age<?
ğŸ‘¶ Young Users (<25): 2

Hibernate: select count(user0_.id) as col_0_0_ from users user0_ where user0_.name like ? escape ?
ğŸ”¤ Users with 'R' in name: 2

Hibernate: select count(user0_.id) as col_0_0_ from users user0_ where user0_.status=? and user0_.age>?
ğŸ’ª Active Adult Users: 2
```

---

## âœ… 4. Rules/Guidelines

### Rule 1: Method Naming Convention âœ…
```java
// âœ… Correct - starts with 'countBy'
long countByStatus(String status);
long countByAge(Integer age);

// âŒ Wrong - doesn't follow naming convention  
long getStatusCount(String status);  // Error: No property getStatusCount found
long numberOfUsers(String status);   // Error: No property numberOfUsers found
```

### Rule 2: Property Names Must Match Entity âœ…
```java
// Entity has properties: name, email, status, age, city

// âœ… Correct - matches entity property names
long countByStatus(String status);
long countByName(String name);
long countByAge(Integer age);

// âŒ Wrong - property doesn't exist in entity
long countByUsername(String username);  // Error: No property username found
long countByLocation(String location);  // Error: No property location found
```

### Rule 3: Parameter Types Must Match âœ…
```java
// Entity: private Integer age;

// âœ… Correct - parameter type matches entity property type
long countByAge(Integer age);

// âŒ Wrong - type mismatch
long countByAge(String age);  // Error: Type mismatch
```

### Rule 4: Multiple Conditions with 'And'/'Or' âœ…
```java
// âœ… Correct - using And/Or
long countByStatusAndAge(String status, Integer age);
long countByStatusOrAge(String status, Integer age);

// âŒ Wrong - missing And/Or
long countByStatusAge(String status, Integer age);  // Error: Invalid method name
```

### Rule 5: Comparison Operations âœ…
```java
// âœ… Correct - valid comparison operations
long countByAgeGreaterThan(Integer age);
long countByAgeLessThan(Integer age);
long countByAgeGreaterThanEqual(Integer age);
long countByAgeLessThanEqual(Integer age);
long countByAgeBetween(Integer start, Integer end);
long countByAgeIn(List<Integer> ages);

// âŒ Wrong - invalid operations
long countByAgeMore(Integer age);     // Error: No property ageMore found
long countByAgeBigger(Integer age);   // Error: No property ageBigger found
```

---

## ğŸŒ 5. Real-world Applications

### Banking Application Example ğŸ¦
```java
@Entity
public class Account {
    @Id
    private Long accountId;
    private String accountType;  // "SAVINGS", "CURRENT", "LOAN"
    private String status;       // "ACTIVE", "INACTIVE", "BLOCKED"
    private Double balance;
    private String branchCode;
    
    // getters and setters
}

@Repository
public interface AccountRepository extends JpaRepository<Account, Long> {
    // Active accounts count
    long countByStatus(String status);
    
    // Account type wise count
    long countByAccountType(String accountType);
    
    // Branch wise active accounts
    long countByStatusAndBranchCode(String status, String branchCode);
    
    // High balance accounts
    long countByBalanceGreaterThan(Double minBalance);
    
    // Zero balance accounts
    long countByBalance(Double balance);
    
    // Custom query for VIP customers (balance > 1 lakh)
    @Query("SELECT COUNT(a) FROM Account a WHERE a.balance > 100000 AND a.status = 'ACTIVE'")
    long countVipCustomers();
}

@Service
public class BankingService {
    
    @Autowired
    private AccountRepository accountRepository;
    
    public BankingStats getBankingStats() {
        BankingStats stats = new BankingStats();
        
        stats.setTotalAccounts(accountRepository.count());
        stats.setActiveAccounts(accountRepository.countByStatus("ACTIVE"));
        stats.setInactiveAccounts(accountRepository.countByStatus("INACTIVE"));
        stats.setBlockedAccounts(accountRepository.countByStatus("BLOCKED"));
        
        stats.setSavingsAccounts(accountRepository.countByAccountType("SAVINGS"));
        stats.setCurrentAccounts(accountRepository.countByAccountType("CURRENT"));
        stats.setLoanAccounts(accountRepository.countByAccountType("LOAN"));
        
        stats.setVipCustomers(accountRepository.countVipCustomers());
        stats.setZeroBalanceAccounts(accountRepository.countByBalance(0.0));
        
        return stats;
    }
}
```

### E-commerce Application Example ğŸ›’
```java
@Entity  
public class Product {
    @Id
    private Long productId;
    private String category;     // "ELECTRONICS", "CLOTHING", "BOOKS"
    private String status;       // "AVAILABLE", "OUT_OF_STOCK", "DISCONTINUED"
    private Double price;
    private Integer stock;
    private Double rating;
    
    // getters and setters
}

@Repository
public interface ProductRepository extends JpaRepository<Product, Long> {
    // Category wise count
    long countByCategory(String category);
    
    // Available products count
    long countByStatus(String status);
    
    // Price range products count
    long countByPriceBetween(Double minPrice, Double maxPrice);
    
    // In-stock products
    long countByStockGreaterThan(Integer minStock);
    
    // High rated products (rating >= 4.0)
    long countByRatingGreaterThanEqual(Double minRating);
    
    // Available products in category with stock
    long countByCategoryAndStatusAndStockGreaterThan(String category, String status, Integer stock);
}

@Service
public class ProductService {
    
    @Autowired
    private ProductRepository productRepository;
    
    public ProductDashboard getProductDashboard() {
        ProductDashboard dashboard = new ProductDashboard();
        
        // Total products
        dashboard.setTotalProducts(productRepository.count());
        
        // Status wise
        dashboard.setAvailableProducts(productRepository.countByStatus("AVAILABLE"));
        dashboard.setOutOfStockProducts(productRepository.countByStatus("OUT_OF_STOCK"));
        dashboard.setDiscontinuedProducts(productRepository.countByStatus("DISCONTINUED"));
        
        // Category wise
        dashboard.setElectronicsCount(productRepository.countByCategory("ELECTRONICS"));
        dashboard.setClothingCount(productRepository.countByCategory("CLOTHING"));
        dashboard.setBooksCount(productRepository.countByCategory("BOOKS"));
        
        // Business insights
        dashboard.setBudgetProducts(productRepository.countByPriceBetween(0.0, 1000.0));
        dashboard.setPremiumProducts(productRepository.countByPriceGreaterThan(10000.0));
        dashboard.setHighRatedProducts(productRepository.countByRatingGreaterThanEqual(4.0));
        
        return dashboard;
    }
}
```

### Educational System Example ğŸ“
```java
@Entity
public class Student {
    @Id
    private Long studentId;
    private String grade;        // "1ST", "2ND", "3RD", etc.
    private String status;       // "ACTIVE", "GRADUATED", "DROPPED"
    private String stream;       // "SCIENCE", "COMMERCE", "ARTS"
    private Double percentage;
    private Integer age;
    
    // getters and setters
}

@Repository
public interface StudentRepository extends JpaRepository<Student, Long> {
    // Grade wise count
    long countByGrade(String grade);
    
    // Stream wise count  
    long countByStream(String stream);
    
    // Active students in grade
    long countByStatusAndGrade(String status, String grade);
    
    // High performers (percentage >= 80%)
    long countByPercentageGreaterThanEqual(Double minPercentage);
    
    // Age group count
    long countByAgeBetween(Integer startAge, Integer endAge);
    
    // Custom query for toppers
    @Query("SELECT COUNT(s) FROM Student s WHERE s.percentage >= 90 AND s.status = 'ACTIVE'")
    long countToppers();
}
```

---

## âš–ï¸ 6. Comparison Tables

### Count Methods Comparison

| Method Type | Example | Use Case | Performance | Flexibility |
|-------------|---------|----------|-------------|-------------|
| **Basic count()** | `count()` | Total records | â­â­â­â­â­ | â­â­ |
| **Derived Query** | `countByStatus()` | Simple conditions | â­â­â­â­ | â­â­â­ |
| **JPQL Query** | `@Query("SELECT COUNT...")` | Complex conditions | â­â­â­ | â­â­â­â­â­ |
| **Native Query** | `@Query(nativeQuery=true)` | Database specific | â­â­â­â­â­ | â­â­â­â­â­ |

### Comparison Operators

| JPA Method | SQL Equivalent | Example |
|------------|----------------|---------|
| `countByAge(Integer age)` | `WHERE age = ?` | Exact match |
| `countByAgeGreaterThan(Integer age)` | `WHERE age > ?` | Greater than |
| `countByAgeGreaterThanEqual(Integer age)` | `WHERE age >= ?` | Greater than equal |
| `countByAgeLessThan(Integer age)` | `WHERE age < ?` | Less than |
| `countByAgeLessThanEqual(Integer age)` | `WHERE age <= ?` | Less than equal |
| `countByAgeBetween(Integer start, Integer end)` | `WHERE age BETWEEN ? AND ?` | Range |
| `countByAgeIn(List<Integer> ages)` | `WHERE age IN (?, ?, ?)` | Multiple values |

### String Operations

| JPA Method | SQL Equivalent | Example |
|------------|----------------|---------|
| `countByName(String name)` | `WHERE name = ?` | Exact match |
| `countByNameContaining(String part)` | `WHERE name LIKE '%?%'` | Contains |
| `countByNameStartingWith(String prefix)` | `WHERE name LIKE '?%'` | Starts with |
| `countByNameEndingWith(String suffix)` | `WHERE name LIKE '%?'` | Ends with |
| `countByNameIgnoreCase(String name)` | `WHERE UPPER(name) = UPPER(?)` | Case insensitive |

---

## ğŸ¯ 7. Interview Questions

### Q1: JPA mein count() method ka use kya hai?
**Answer:**
Count method is used to return the total number of entities in the JpaRepository. Ye method database table mein total records ka count return karta hai.

**Code Example:**
```java
@Repository
public interface UserRepository extends JpaRepository<User, Long> {
    // Built-in count method - total records
    // count() method automatically available hai
}

@Service  
public class UserService {
    @Autowired
    private UserRepository userRepository;
    
    public long getTotalUsers() {
        return userRepository.count(); // Total users count
    }
}
```

### Q2: Conditional counting kaise karte hain?
**Answer:**
Conditional counting ke liye **derived query methods** use karte hain jo `countBy` se start hote hain.

**Code Example:**
```java
@Repository
public interface UserRepository extends JpaRepository<User, Long> {
    // Single condition
    long countByStatus(String status);
    
    // Multiple conditions with AND
    long countByStatusAndCity(String status, String city);
    
    // Multiple conditions with OR  
    long countByStatusOrAge(String status, Integer age);
    
    // Comparison operations
    long countByAgeGreaterThan(Integer age);
    long countByAgeBetween(Integer startAge, Integer endAge);
}

// Usage
@Service
public class UserService {
    @Autowired
    private UserRepository userRepository;
    
    public UserStats getUserStats() {
        UserStats stats = new UserStats();
        
        stats.setActiveUsers(userRepository.countByStatus("ACTIVE"));
        stats.setInactiveUsers(userRepository.countByStatus("INACTIVE"));
        stats.setAdultUsers(userRepository.countByAgeGreaterThan(18));
        stats.setYoungAdults(userRepository.countByAgeBetween(18, 30));
        
        return stats;
    }
}
```

### Q3: Custom count queries kaise likhte hain?
**Answer:**
Complex conditions ke liye `@Query` annotation use karte hain JPQL ya Native SQL ke saath.

**Code Example:**
```java
@Repository
public interface UserRepository extends JpaRepository<User, Long> {
    
    // JPQL Query
    @Query("SELECT COUNT(u) FROM User u WHERE u.status = :status AND u.age > :minAge")
    long countActiveUsersAboveAge(@Param("status") String status, @Param("minAge") Integer minAge);
    
    // Native SQL Query
    @Query(value = "SELECT COUNT(*) FROM users u WHERE u.status = ?1 AND u.created_date > ?2", 
           nativeQuery = true)
    long countRecentActiveUsers(String status, Date afterDate);
    
    // Complex business logic
    @Query("SELECT COUNT(u) FROM User u WHERE u.status = 'ACTIVE' AND " +
           "u.lastLoginDate > :cutoffDate AND u.subscriptionType = :type")
    long countActiveSubscribersAfterDate(@Param("cutoffDate") Date date, 
                                        @Param("type") String subscriptionType);
}
```

### Q4: Performance considerations kya hain count queries mein?
**Answer:**

**Performance Tips:**
1. **Index** lagao frequently used columns par
2. **count()** faster hai than `findAll().size()`  
3. **Native queries** sometimes faster for complex counts
4. **Avoid** count queries in loops

**Code Example:**
```java
@Entity
@Table(name = "users", indexes = {
    @Index(name = "idx_status", columnList = "status"),
    @Index(name = "idx_age", columnList = "age"),
    @Index(name = "idx_status_age", columnList = "status, age")
})
public class User {
    // entity fields
}

// âœ… Good Performance
@Service
public class UserService {
    
    // Single query for all counts
    public UserStatistics getUserStatistics() {
        // Use batch queries or single complex query instead of multiple counts
        return userRepository.getUserStatisticsInBatch();
    }
}

// âŒ Bad Performance  
@Service  
public class BadUserService {
    
    public List<UserStats> getUserStatsForAllCities() {
        List<String> cities = getCities();
        List<UserStats> stats = new ArrayList<>();
        
        // Wrong: N+1 query problem
        for(String city : cities) {
            long count = userRepository.countByCity(city); // Multiple DB calls
            stats.add(new UserStats(city, count));
        }
        
        return stats;
    }
}
```

### Q5: count() vs exists() kab use karna chahiye?
**Answer:**

| Scenario | Use | Reason |
|----------|-----|--------|
| **Actual count chahiye** | `count()` | Business logic mein number use hota hai |
| **Sirf existence check** | `exists()` | Faster for boolean operations |
| **Zero vs Non-zero check** | `exists()` | No need to count all |
| **Reporting/Analytics** | `count()` | Exact numbers required |

**Code Example:**
```java
@Repository
public interface UserRepository extends JpaRepository<User, Long> {
    // For getting actual count
    long countByStatus(String status);
    
    // For boolean existence check
    boolean existsByStatus(String status);
    boolean existsByEmail(String email);
}

@Service
public class UserService {
    
    // âœ… Good: Using exists for boolean check
    public boolean hasActiveUsers() {
        return userRepository.existsByStatus("ACTIVE");
    }
    
    // âœ… Good: Using count when actual number needed
    public String getActiveUsersMessage() {
        long count = userRepository.countByStatus("ACTIVE");
        return "You have " + count + " active users";
    }
    
    // âŒ Bad: Using count for boolean check
    public boolean hasActiveUsersBad() {
        return userRepository.countByStatus("ACTIVE") > 0; // Unnecessary counting
    }
}
```

### Q6: Pagination ke saath count kaise use karte hain?
**Answer:**
Pagination mein **total pages** calculate karne ke liye count use karte hain.

**Code Example:**
```java
@Service
public class UserService {
    
    @Autowired
    private UserRepository userRepository;
    
    public Page<User> getUsersWithPagination(String status, int page, int size) {
        Pageable pageable = PageRequest.of(page, size);
        
        if (status != null) {
            return userRepository.findByStatus(status, pageable);
        } else {
            return userRepository.findAll(pageable);
        }
    }
    
    public PaginationInfo getPaginationInfo(String status, int size) {
        long totalElements;
        
        if (status != null) {
            totalElements = userRepository.countByStatus(status);
        } else {
            totalElements = userRepository.count();
        }
        
        int totalPages = (int) Math.ceil((double) totalElements / size);
        
        return new PaginationInfo(totalElements, totalPages, size);
    }
}

@RestController
public class UserController {
    
    @Autowired
    private UserService userService;
    
    @GetMapping("/users")
    public ResponseEntity<PagedResponse<User>> getUsers(
            @RequestParam(defaultValue = "0") int page,
            @RequestParam(defaultValue = "10") int size,
            @RequestParam(required = false) String status) {
        
        Page<User> userPage = userService.getUsersWithPagination(status, page, size);
        
        PagedResponse<User> response = new PagedResponse<>();
        response.setContent(userPage.getContent());
        response.setPage(userPage.getNumber());
        response.setSize(userPage.getSize());
        response.setTotalElements(userPage.getTotalElements()); // ye count use karta hai internally
        response.setTotalPages(userPage.getTotalPages());
        
        return ResponseEntity.ok(response);
    }
}
```

---

## âŒ 8. Common Mistakes

### Mistake 1: Wrong Method Names ğŸš«
```java
// âŒ Wrong
public interface UserRepository extends JpaRepository<User, Long> {
    long getCountByStatus(String status);    // Should start with 'countBy'
    long numberOfActiveUsers();              // No property mapping
    long statusCount(String status);         // Wrong naming convention
}
